###########################################################################################################
# Inicia a geração da imagem
###########################################################################################################

FROM ubuntu:latest

###########################################################################################################
# Efetua a instalação do nodejs
###########################################################################################################

RUN apt update && apt install -y nodejs && apt install -y npm

###########################################################################################################
# Efetua a criação do diretório da aplicação
###########################################################################################################

RUN mkdir -v -p /visto/view
RUN mkdir -v -p /visto/view/.next
RUN mkdir -v -p /visto/view/node_modules

###########################################################################################################
# Efetua a cópia dos arquivos necessários
###########################################################################################################

COPY package.json /visto/view
COPY start-view.sh /visto/view
COPY .next/ /visto/view/.next
COPY node_modules/ /visto/view/node_modules

###########################################################################################################
# Entra no diretório da aplicação
###########################################################################################################

RUN cd /visto/view

###########################################################################################################
# Expõe a porta 3000 para acesso a api
###########################################################################################################

#EXPOSE 3000:3000

###########################################################################################################
# Inicia a execução da aplicação
###########################################################################################################

ENTRYPOINT ["/visto/view/start-view.sh"]